# config/services.yaml
parameters:
  credit_initial: 20
  frais_plateforme: 2
  mail_from: "no-reply@ecoride.fr"
  mail_reply_to: "contact@ecoride.fr"

  # MongoDB (ODM)
  mongodb_db: "%env(string:MONGODB_DB)%"

  # Valeurs locales par d√©faut (override dans .env.local)
  env(MONGODB_URL): "mongodb://127.0.0.1:27017"
  env(MONGODB_DB): "ecoride"

  # Alias optionnel pour certaines recettes qui attendent MONGODB_URI
  env(MONGODB_URI): "%env(resolve:MONGODB_URL)%"

services:
  _defaults:
    autowire: true
    autoconfigure: true

  App\:
    resource: "../src/"
    exclude:
      - "../src/DependencyInjection/"
      - "../src/Entity/"
      - "../src/Kernel.php"

  App\Service\NotificationService:
    arguments:
      $fromEmail: "%mail_from%"
      $replyTo: "%mail_reply_to%"

  App\Service\Frais:
    arguments:
      $fraisPlateforme: "%frais_plateforme%"

  App\Controller\Api\UtilisateurController:
    arguments:
      $creditInitial: "%credit_initial%"

  App\Controller\ContactController:
    arguments:
      $mailFrom: "%mail_from%"
      $mailReplyTo: "%mail_reply_to%"

  App\EventListener\LoginSuccessListener:
    tags:
      - {
          name: kernel.event_listener,
          event: security.interactive_login,
          method: onSecurityInteractiveLogin,
        }

  App\Command\InsertStatistiqueCommand:
    autowire: true
    autoconfigure: true
    tags:
      - { name: "console.command", command: "ecoride:stats:insert" }

  App\Command\StatsListCommand:
    autowire: true
    autoconfigure: true
    tags:
      - { name: "console.command", command: "ecoride:stats:list" }

  App\Command\StatsDeleteCommand:
    autowire: true
    autoconfigure: true
    tags:
      - { name: "console.command", command: "ecoride:stats:delete" }
